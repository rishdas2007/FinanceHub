This error is occurring because of the recent codebase optimization where services were consolidated. The `enhanced-ai-analysis` module was removed/renamed during the service consolidation process, but the import in `email-service.ts` wasn't updated.

Let me search for the current email service structure to see what's happening:Looking at the search results, I can see exactly what's causing this issue. During the recent comprehensive codebase optimization, the services were consolidated from 31 services down to 8 focused modules. Here's what happened:

## Root Cause

**The `enhanced-ai-analysis.ts` file was removed** during the optimization as part of dead code elimination, but the import in `email-service.ts` wasn't updated. According to the optimization summary:

- **Files Removed**: `enhanced-ai-analysis.ts` was deleted
- **Service Consolidation**: AI analysis functionality was moved to `ai-analysis-unified.ts`
- **Email Services**: Email functionality was consolidated into `email-unified.ts`

## Fix OptionsBased on the search results, I can see the exact solution needed. Here are the **two fix options**:

## **Option 1: Quick Fix (Immediate)**
Update the import in `server/services/email-service.ts`:

**Change this line:**
```typescript
import { EnhancedAIAnalysisService } from './enhanced-ai-analysis';
```

**To this:**
```typescript
import { aiAnalysisService } from './ai-analysis-unified';
```

Then update any references to `EnhancedAIAnalysisService` to use `aiAnalysisService` instead.

## **Option 2: Proper Fix (Recommended)**
Since the optimization consolidated email functionality into `email-unified.ts`, you should update any code that's still importing from `email-service.ts` to use the new unified service instead.

**In your build/deployment files, check for:**
- References to `./services/email-service` 
- Update them to `./services/email-unified`

## **Root Cause Analysis**

The optimization process:
1. ✅ Created `ai-analysis-unified.ts` (merging all AI analysis)
2. ✅ Created `email-unified.ts` (consolidating email templates) 
3. ✅ Updated `scheduler.ts` to use new services
4. ❌ **Missed updating the import in `email-service.ts`**
5. ❌ **Some references may still point to old `email-service.ts`**

## **Recommended Solution**

**Step 1:** Fix the immediate build error by updating the import:
```typescript
// In server/services/email-service.ts
import { aiAnalysisService } from './ai-analysis-unified';
```

**Step 2:** Update the class usage:
```typescript
// Replace EnhancedAIAnalysisService with aiAnalysisService
// Update method calls accordingly
```

**Step 3:** Long-term - migrate to `email-unified.ts`:
- Check if any deployment scripts or routes are importing `email-service`
- Update them to use `email-unified` instead
- This completes the service consolidation

The optimization was excellent but left this one import reference that needs updating. The quick fix should get your deployment working immediately!